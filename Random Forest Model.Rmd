---
title: "Random Forest Model"
output: html_document
---

```{r}
library(tidyverse)
library(caret)
library(randomForest)
```

Loading data: 
```{r}
bikeShare <- read.csv(file="/Users/christinemarieheubusch/Final-Project/Bike-Sharing-Dataset_day.csv") %>% select(-c("instant", "dteday"))
```


Separating data into train and test sets:
{r}
  train <- sample(1:nrow(bikeShare, size=nrow(bikeShare)*0.8))
  test <- dplyr::setdiff(1:nrow(bikeShare), train)
  bikeTrain <- bikeShare[train,]
  bikeTest <- bikeShare[test,]


```{r}
rf <- randomForest(cnt~.,
                  data=bikeShare,
                  ntree=500,
                  mtry=3,
                  importance=TRUE)
```

```{r}
saveRDS(rf, "model_rf.rds")
```


  #Building regression model

  predicted.training <- resultRF$predicted
  actual.training <- bikeTrain$cnt
  
  rfTbl <- table(data.frame(pred=predict(rfTree, bikeTest), true=bikeTest$cnt))
  rf=sum(diag(rfTbl)/sum(rfTbl))
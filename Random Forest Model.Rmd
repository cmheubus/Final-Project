---
title: "Random Forest Model"
output: html_document
---

```{r}
library(tidyverse)
library(caret)
library(randomForest)
```

Loading data: 
```{r}
bikeShare <- read.csv(file="/Users/christinemarieheubusch/Final-Project/Bike-Sharing-Dataset_day.csv") %>% select(-c("instant", "dteday"))
```


Separating data into train and test sets:
```{r}
bikeReact4 <- reactive({
    newData <- bikeShare[input$varCheck] 
  })
  train <- sample(1:nrow(bikeReact4()), size=nrow(bikeReact4())*0.8)
  test <- dplyr::setdiff(1:nrow(bikeReact4()), train)
  bikeTrain <- bikeReact4()[train,]
  bikeTest <- bikeReact4()[test,]
  target.variable <- "cnt"
```

  
  #Building regression model
  rtTree <- randomForest(cnt~.,
                           data=bikeTrain,
                           ntree=500,
                           mtry=3,
                           importance=TRUE,
                           na.action=randomForest::na.roughfix,
                           replace=FALSE)
  predicted.training <- resultRF$predicted
  actual.training <- bikeTrain$cnt
  
  rfTbl <- table(data.frame(pred=predict(rfTree, bikeTest), true=bikeTest$cnt))
  rf=sum(diag(rfTbl)/sum(rfTbl))